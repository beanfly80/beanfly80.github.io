---
layout: post
title:  "WebPack"
categories: dev
date : 2017-05-20 20:09:40 +09:00
---

Module bundler
- reference : http://webpack.js.org
- ToC
    - [Introduction](#Introduction)
    - [Concepts](#Concepts)
    - [Module](#Module)
    - [Usage](#Usage)

---

## Introduction
Webpack is a tool to build JavaScript modules in your application including images, fonts, and CSS, in a dependency graph.

- Goals
    - Split the dependency tree into chunks loaded on demand
    - Keep initial loading time low
    - Every static asset should be able to be a module
    - Ability to integrate 3rd-party libraries as modules
    - Ability to customize nearly every part of the module bundler
    - Suited for big projects

- Directory
    ```
    webpack-demo
    |- package.json
    |- package-lock.json
    |- webpack.config.js    # for webpack
    |- /dist
      |- main.js
      |- index.html
    |- /src
      |- index.js    #[built] [code generated]
    |- /node_modules #[built] [code generated]
    ```

## [Concepts](https://webpack.js.org/concepts/)
 1. Entry
    ```
    # webpack.config.js
    module.exports = {
      entry: {
        main: './path/to/my/entry/file.js',
      },
    };
    ```
 2. Output : Ouput folder & files
     ```
     # webpack.config.js
    const path = require('path');
    module.exports = {
      entry: './path/to/my/entry/file.js',
      output: {
        path: path.resolve(__dirname, 'dist'),
        filename: 'my-first-webpack.bundle.js',
      },
    };
     ```
 3. Loaders
    - Webpack only understands JavaScript and JSON files.
    - Loaders allow webpack to process other types of files and convert them into valid modules.
 4. Plugins 
    - bundle optimization
    - asset management
    - injection of environment variables.
 5. Mode : By setting the mode parameter
    - development
    - production
    - none : Opts out of any default optimization options

## Module 
webpack modules express their dependencies
 - An ES2015 import statement
 - A CommonJS require() statement : 
    ```
    require(dependency: String)
    ```
 - An AMD define and require statement : 
    ```
    define([name: String], [dependencies: String[]], factoryMethod: function(...))
    require(dependencies: String[], [callback: function(...)])
    ```
 - An @import statement inside of a css/sass/less file.
 - An image url in a stylesheet (url(...)) or html (<img src=...>) file.

## Usage
    ```
    # install
    npm install --save-dev webpack
    ## or specific version
    npm install --save-dev webpack@<version>
    
    # Build : 
    webpack  [-w -p] <entry> [<entry>] <output>
    
    # webpack.config.js
    webpack --config path
    ```
### Examples
 1. Using Webpack with RequireJS
    ```
    $ webpack  ./entry.js ./bundle.js
    # templates/a.js
    module.exports.fun = function() {
        return "This text was generated by template A function";
    }
    # entry.js
    alert(require("./templates/a").fun());
    # index.html
    <script src="lib/require.js" data-main="bundle"></script>
    ```
 2. Configuration
     ```
    $ webpack
    # templates/a.js
    module.exports.fun = function() {
        return "This text was generated by template A function";
    }
    # entry.js
    alert(require("./templates/a").fun());
    index.html
    <script src="lib/require.js" data-main="bundle"></script>
    # webpack.config.js
    {   context: __dirname + "/src",
        entry: "./entry",
        output: {
            path: __dirname + "/out",
            filename: "bundle.js"
    }}
    ```

 3. Loader
    ```
    $ npm install --save-dev style-loader css-loader

    # style.css
    .classColor {  color: blue; }
    1) via webpack.config.js
    // webpack.config.js. 파일 형식과 로더 지정.
    module.exports = { //...
      module: { loaders: [	{ test: /\.css?$/, loader: "style-loader!css-loader" } ]       } ...
    
    
    //javascript file example. 
    import myalias from './style.css';
    element.innerHTML = '<div class="' + myalias.classColor + '">';
    2) inline
    // javascript file
    import myalias from 'style-loader!css-loader! ./style.css'
    3) CLI 
    // javascript file. 
    import myalias from './style.css'
    
    // CLI. 아래 css 자리는 파일 형식. 로더에 따라 js, less 등이 올 수 있음.
    $ webpack --module-bind 'css=style-loader!cssloader'

    ```
